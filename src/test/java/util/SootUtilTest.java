package util;

import org.junit.Test;
import utiil.SootUtil;

import static org.junit.Assert.*;

public class SootUtilTest {
    @Test(timeout = 4000)
    public void testMethodSigToParams() {
        String methodSig = "<org.apache.logging.log4j.core.net.server.TcpSocketServer: org.apache.logging.log4j.core.net.server.TcpSocketServer createSerializedSocketServer(int,int,java.net.InetAddress)>";
        String[] params = SootUtil.methodSigToParams(methodSig);
        assertEquals("int", params[0]);
        assertEquals("int", params[1]);
        assertEquals("java.net.InetAddress", params[2]);
    }

    @Test(timeout = 4000)
    public void testMethodSigToParams1() {
        String methodSig = "<org.apache.logging.log4j.core.net.server.TcpSocketServer: void shutdown()>";
        String[] params = SootUtil.methodSigToParams(methodSig);
        assertEquals(1, params.length);
    }

    @Test(timeout = 4000)
    public void testIsSameParams() {
        String source = "int,int,java.net.InetAddress";
        String target = "int,int,InetAddress";
        assertTrue(SootUtil.isSameParams(source.split(","), target.split(",")));
    }
}
