package detect;

import container.DependencyRisks;
import graph.PathGraph;
import org.apache.maven.plugins.annotations.LifecyclePhase;
import org.apache.maven.plugins.annotations.Mojo;
import risk.DependencyRisk;

import java.util.Set;

//mvn -f=pom.xml -DignoreTestScope=true -Dmaven.test.skip=true xmu:CVE-Detect:1.0:detectCVE -e
@Mojo(name = "detectCVE", defaultPhase = LifecyclePhase.VALIDATE)
public class DetectCVEMojo extends DetectMojo {

    @Override
    public void run() {
        for (DependencyRisk dependencyRisk : DependencyRisks.i().getAllDependencyRisks()) {
//            System.out.println(dependencyRisk);
          PathGraph pathGraph =  dependencyRisk.getPathGraph();
            Set<String> hostNodes = pathGraph.getHostNodes();
            for (String hostNode : hostNodes){
                System.out.println(hostNode);
            }
        }
    }

}