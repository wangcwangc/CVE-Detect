package detect;

import container.DependencyJars;
import container.DependencyRisks;
import graph.*;
import org.apache.maven.plugins.annotations.LifecyclePhase;
import org.apache.maven.plugins.annotations.Mojo;
import risk.DependencyRisk;
import utiil.Conf;
import utiil.SootUtil;
import vo.DependencyJar;

import java.util.Map;
import java.util.Set;
import java.util.TreeMap;

//mvn -f=pom.xml -DignoreTestScope=true -Dmaven.test.skip=true xmu:CVE-Detect:1.0:detectCVE -e
@Mojo(name = "detectCVE", defaultPhase = LifecyclePhase.VALIDATE)
public class DetectCVEMojo extends DetectMojo {

    @Override
    public void run() {
        for (DependencyRisk dependencyRisk : DependencyRisks.i().getAllDependencyRisks()) {
//            System.out.println(dependencyRisk);
            PathGraph pathGraph = dependencyRisk.getPathGraph();
        }
    }
}